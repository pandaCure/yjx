Please review the code below to detect security defects. If any are found, please describe the security defect in detail and indicate the corresponding line number of code and solution. If none are found, please state '''No security defects are detected in the code'''.

1 {
2     "context_is_admin":  "role:admin",
3     "owner": "tenant_id:%(tenant_id)s",
4     "admin_or_owner": "rule:context_is_admin or rule:owner",
5     "context_is_advsvc":  "role:advsvc",
6     "admin_or_network_owner": "rule:context_is_admin or tenant_id:%(network:tenant_id)s",
7     "admin_owner_or_network_owner": "rule:owner or rule:admin_or_network_owner",
8     "admin_only": "rule:context_is_admin",
9     "regular_user": "",
10     "admin_or_data_plane_int": "rule:context_is_admin or role:data_plane_integrator",
11     "shared": "field:networks:shared=True",
12     "shared_subnetpools": "field:subnetpools:shared=True",
13     "shared_address_scopes": "field:address_scopes:shared=True",
14     "external": "field:networks:router:external=True",
15     "default": "rule:admin_or_owner",
16     "admin_or_floatingip_owner": "rule:context_is_admin or tenant_id:%(floatingip:tenant_id)s",
17 
18     "create_subnet": "rule:admin_or_network_owner",
19     "create_subnet:segment_id": "rule:admin_only",
20     "create_subnet:service_types": "rule:admin_only",
21     "get_subnet": "rule:admin_or_owner or rule:shared",
22     "get_subnet:segment_id": "rule:admin_only",
23     "update_subnet": "rule:admin_or_network_owner",
24     "update_subnet:service_types": "rule:admin_only",
25     "delete_subnet": "rule:admin_or_network_owner",
26 
27     "create_subnetpool": "",
28     "create_subnetpool:shared": "rule:admin_only",
29     "create_subnetpool:is_default": "rule:admin_only",
30     "get_subnetpool": "rule:admin_or_owner or rule:shared_subnetpools",
31     "update_subnetpool": "rule:admin_or_owner",
32     "update_subnetpool:is_default": "rule:admin_only",
33     "delete_subnetpool": "rule:admin_or_owner",
34 
35     "create_address_scope": "",
36     "create_address_scope:shared": "rule:admin_only",
37     "get_address_scope": "rule:admin_or_owner or rule:shared_address_scopes",
38     "update_address_scope": "rule:admin_or_owner",
39     "update_address_scope:shared": "rule:admin_only",
40     "delete_address_scope": "rule:admin_or_owner",
41 
42     "create_network": "",
43     "create_network:shared": "rule:admin_only",
44     "create_network:router:external": "rule:admin_only",
45     "create_network:is_default": "rule:admin_only",
46     "create_network:segments": "rule:admin_only",
47     "create_network:provider:network_type": "rule:admin_only",
48     "create_network:provider:physical_network": "rule:admin_only",
49     "create_network:provider:segmentation_id": "rule:admin_only",
50     "get_network": "rule:admin_or_owner or rule:shared or rule:external or rule:context_is_advsvc",
51     "get_network:router:external": "rule:regular_user",
52     "get_network:segments": "rule:admin_only",
53     "get_network:provider:network_type": "rule:admin_only",
54     "get_network:provider:physical_network": "rule:admin_only",
55     "get_network:provider:segmentation_id": "rule:admin_only",
56     "get_network:queue_id": "rule:admin_only",
57     "get_network_ip_availabilities": "rule:admin_only",
58     "get_network_ip_availability": "rule:admin_only",
59     "update_network": "rule:admin_or_owner",
60     "update_network:segments": "rule:admin_only",
61     "update_network:shared": "rule:admin_only",
62     "update_network:provider:network_type": "rule:admin_only",
63     "update_network:provider:physical_network": "rule:admin_only",
64     "update_network:provider:segmentation_id": "rule:admin_only",
65     "update_network:router:external": "rule:admin_only",
66     "delete_network": "rule:admin_or_owner",
67 
68     "create_segment": "rule:admin_only",
69     "get_segment": "rule:admin_only",
70     "update_segment": "rule:admin_only",
71     "delete_segment": "rule:admin_only",
72 
73     "network_device": "field:port:device_owner=~^network:",
74     "create_port": "",
75     "create_port:device_owner": "not rule:network_device or rule:context_is_advsvc or rule:admin_or_network_owner",
76     "create_port:mac_address": "rule:context_is_advsvc or rule:admin_or_network_owner",
77     "create_port:fixed_ips:ip_address": "rule:context_is_advsvc or rule:admin_or_network_owner",
78     "create_port:fixed_ips:subnet_id": "rule:context_is_advsvc or rule:admin_or_network_owner or rule:shared",
79     "create_port:port_security_enabled": "rule:context_is_advsvc or rule:admin_or_network_owner",
80     "create_port:binding:host_id": "rule:admin_only",
81     "create_port:binding:profile": "rule:admin_only",
82     "create_port:mac_learning_enabled": "rule:context_is_advsvc or rule:admin_or_network_owner",
83     "create_port:allowed_address_pairs": "rule:admin_or_network_owner",
84     "get_port": "rule:context_is_advsvc or rule:admin_owner_or_network_owner",
85     "get_port:queue_id": "rule:admin_only",
86     "get_port:binding:vif_type": "rule:admin_only",
87     "get_port:binding:vif_details": "rule:admin_only",
88     "get_port:binding:host_id": "rule:admin_only",
89     "get_port:binding:profile": "rule:admin_only",
90     "update_port": "rule:admin_or_owner or rule:context_is_advsvc",
91     "update_port:device_owner": "not rule:network_device or rule:context_is_advsvc or rule:admin_or_network_owner",
92     "update_port:mac_address": "rule:admin_only or rule:context_is_advsvc",
93     "update_port:fixed_ips:ip_address": "rule:context_is_advsvc or rule:admin_or_network_owner",
94     "update_port:fixed_ips:subnet_id": "rule:context_is_advsvc or rule:admin_or_network_owner or rule:shared",
95     "update_port:port_security_enabled": "rule:context_is_advsvc or rule:admin_or_network_owner",
96     "update_port:binding:host_id": "rule:admin_only",
97     "update_port:binding:profile": "rule:admin_only",
98     "update_port:mac_learning_enabled": "rule:context_is_advsvc or rule:admin_or_network_owner",
99     "update_port:allowed_address_pairs": "rule:admin_or_network_owner",
100     "update_port:data_plane_status": "rule:admin_or_data_plane_int",
101     "delete_port": "rule:context_is_advsvc or rule:admin_owner_or_network_owner",
102 
103     "create_router": "rule:regular_user",
104     "create_router:external_gateway_info:enable_snat": "rule:admin_only",
105     "create_router:external_gateway_info:external_fixed_ips": "rule:admin_only",
106     "create_router:distributed": "rule:admin_only",
107     "create_router:ha": "rule:admin_only",
108     "get_router": "rule:admin_or_owner",
109     "get_router:ha": "rule:admin_only",
110     "get_router:distributed": "rule:admin_only",
111     "update_router": "rule:admin_or_owner",
112     "update_router:external_gateway_info": "rule:admin_or_owner",
113     "update_router:external_gateway_info:network_id": "rule:admin_or_owner",
114     "update_router:external_gateway_info:enable_snat": "rule:admin_only",
115     "update_router:external_gateway_info:external_fixed_ips": "rule:admin_only",
116     "update_router:distributed": "rule:admin_only",
117     "update_router:ha": "rule:admin_only",
118     "delete_router": "rule:admin_or_owner",
119 
120     "add_router_interface": "rule:admin_or_owner",
121     "remove_router_interface": "rule:admin_or_owner",
122 
123     "create_qos_queue": "rule:admin_only",
124     "get_qos_queue": "rule:admin_only",
125 
126     "get_agent": "rule:admin_only",
127     "update_agent": "rule:admin_only",
128     "delete_agent": "rule:admin_only",
129 
130     "create_dhcp-network": "rule:admin_only",
131     "get_dhcp-networks": "rule:admin_only",
132     "delete_dhcp-network": "rule:admin_only",
133 
134     "create_l3-router": "rule:admin_only",
135     "get_l3-routers": "rule:admin_only",
136     "delete_l3-router": "rule:admin_only",
137 
138     "get_dhcp-agents": "rule:admin_only",
139     "get_l3-agents": "rule:admin_only",
140 
141     "get_loadbalancer-agent": "rule:admin_only",
142     "get_loadbalancer-pools": "rule:admin_only",
143     "get_agent-loadbalancers": "rule:admin_only",
144     "get_loadbalancer-hosting-agent": "rule:admin_only",
145 
146     "create_floatingip": "rule:regular_user",
147     "create_floatingip:floating_ip_address": "rule:admin_only",
148     "get_floatingip": "rule:admin_or_owner",
149     "update_floatingip": "rule:admin_or_owner",
150     "delete_floatingip": "rule:admin_or_owner",
151 
152     "create_network_profile": "rule:admin_only",
153     "get_network_profiles": "",
154     "get_network_profile": "",
155     "update_network_profile": "rule:admin_only",
156     "delete_network_profile": "rule:admin_only",
157 
158     "get_policy_profiles": "",
159     "get_policy_profile": "",
160     "update_policy_profiles": "rule:admin_only",
161 
162     "create_metering_label": "rule:admin_only",
163     "get_metering_label": "rule:admin_only",
164     "delete_metering_label": "rule:admin_only",
165 
166     "create_metering_label_rule": "rule:admin_only",
167     "get_metering_label_rule": "rule:admin_only",
168     "delete_metering_label_rule": "rule:admin_only",
169 
170     "create_lsn": "rule:admin_only",
171     "get_lsn": "rule:admin_only",
172 
173     "get_service_provider": "rule:regular_user",
174 
175     "create_flavor": "rule:admin_only",
176     "get_flavors": "rule:regular_user",
177     "get_flavor": "rule:regular_user",
178     "update_flavor": "rule:admin_only",
179     "delete_flavor": "rule:admin_only",
180 
181     "create_service_profile": "rule:admin_only",
182     "get_service_profiles": "rule:admin_only",
183     "get_service_profile": "rule:admin_only",
184     "update_service_profile": "rule:admin_only",
185     "delete_service_profile": "rule:admin_only",
186 
187     "create_policy": "rule:admin_only",
188     "get_policy": "rule:regular_user",
189     "update_policy": "rule:admin_only",
190     "delete_policy": "rule:admin_only",
191 
192     "create_policy_bandwidth_limit_rule": "rule:admin_only",
193     "get_policy_bandwidth_limit_rule": "rule:regular_user",
194     "update_policy_bandwidth_limit_rule": "rule:admin_only",
195     "delete_policy_bandwidth_limit_rule": "rule:admin_only",
196 
197     "create_policy_dscp_marking_rule": "rule:admin_only",
198     "get_policy_dscp_marking_rule": "rule:regular_user",
199     "update_policy_dscp_marking_rule": "rule:admin_only",
200     "delete_policy_dscp_marking_rule": "rule:admin_only",
201 
202     "get_rule_type": "rule:regular_user",
203 
204     "create_policy_minimum_bandwidth_rule": "rule:admin_only",
205     "get_policy_minimum_bandwidth_rule": "rule:regular_user",
206     "update_policy_minimum_bandwidth_rule": "rule:admin_only",
207     "delete_policy_minimum_bandwidth_rule": "rule:admin_only",
208 
209     "restrict_wildcard": "(not field:rbac_policy:target_tenant=*) or rule:admin_only",
210     "create_rbac_policy": "",
211     "create_rbac_policy:target_tenant": "rule:restrict_wildcard",
212     "get_rbac_policy": "rule:admin_or_owner",
213     "update_rbac_policy": "rule:admin_or_owner",
214     "update_rbac_policy:target_tenant": "rule:restrict_wildcard and rule:admin_or_owner",
215     "delete_rbac_policy": "rule:admin_or_owner",
216 
217     "create_flavor_service_profile": "rule:admin_only",
218     "get_flavor_service_profile": "rule:regular_user",
219     "delete_flavor_service_profile": "rule:admin_only",
220 
221     "get_auto_allocated_topology": "rule:admin_or_owner",
222 
223     "create_trunk": "rule:regular_user",
224     "get_trunk": "rule:admin_or_owner",
225     "delete_trunk": "rule:admin_or_owner",
226 
227     "add_subports": "rule:admin_or_owner",
228     "get_subports": "",
229     "remove_subports": "rule:admin_or_owner",
230 
231     "create_security_group": "rule:admin_or_owner",
232     "get_security_groups": "rule:admin_or_owner",
233     "get_security_group": "rule:admin_or_owner",
234     "update_security_group": "rule:admin_or_owner",
235     "delete_security_group": "rule:admin_or_owner",
236 
237     "create_security_group_rule": "rule:admin_or_owner",
238     "get_security_group_rules": "rule:admin_or_owner",
239     "get_security_group_rule": "rule:admin_or_owner",
240     "delete_security_group_rule": "rule:admin_or_owner",
241 
242     "get_loggable_resources": "rule:admin_only",
243 
244     "create_log": "rule:admin_only",
245     "get_log": "rule:admin_only",
246     "get_logs": "rule:admin_only",
247     "update_log": "rule:admin_only",
248     "delete_log": "rule:admin_only",
249 
250     "create_floatingip_port_forwarding": "rule:admin_or_floatingip_owner",
251     "update_floatingip_port_forwarding": "rule:admin_or_floatingip_owner",
252     "get_floatingip_port_forwarding": "rule:admin_or_floatingip_owner",
253     "get_floatingip_port_forwardings": "rule:admin_or_floatingip_owner",
254     "delete_floatingip_port_forwarding": "rule:admin_or_floatingip_owner"
255 }
